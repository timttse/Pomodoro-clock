<!DOCTYPE html>
<html>
<head>
	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">
  	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
  	<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
  	<link href='https://fonts.googleapis.com/css?family=Orbitron' rel='stylesheet' type='text/css'>
  	<!-- <link rel="stylesheet" type="text/css" href="styles.css"> -->
  	<script src="clock.js"></script>
  	<!-- <script src="script.js"></script> -->
	<title>Pomodoro Clock</title>

	<script>
		var currentTimer='';

		function startTimers(timer1,timer2){
			currentTimer=timer1.name;
			timer1.startTimer($(".countdown"),100);
			console.log(currentTimer);

			var t=setInterval(function(){
				// console.log(timer1.getMilliseconds());
				if(timer1.getMilliseconds()===0){
					clearInterval(t);
					timer1.stopTimer();
					timer1.reset();
					$(".countdown").text(timer2.timeString);
					startTimers(timer2,timer1);
				}
			},100);
		}

		function stopTimers(timer1,timer2){
			if(timer1.isRunning()){
				timer1.stopTimer();
			}
			if(timer2.isRunning()){
				timer2.stopTimer();
			}
		}

		$(document).ready(function(){
			
			// get session time
			var sessionInMil=$(".time").val()*60*1000;
			var s=new Clock("session",sessionInMil);
			//console.log(s.getSeconds());

			var breakInMil=$(".break").val()*60*1000;
			var b=new Clock("break",breakInMil);

			$(".countdown").text(s.getMinutes());


			// start button
			$(".startTimer").click(function(){
				// s.startTimer($(".countdown"),100);

				if(!s.isRunning() && !b.isRunning()) {
					if(currentTimer==='' || currentTimer==='session'){
						startTimers(s,b);
					} else if (currentTimer='break'){
						startTimers(b,s);
					}
				}
			});


			// stop/pause button
			$(".stopTimer").click(function(){
				stopTimers(s,b);
			});

	    });

	</script>

</head>
<body>
	<div class="container-fluid text-center">
		<div class="row">
		<!-- <span class="time">1</span><span> min</span>-->
		<div class="col-sm-6"><label>Break Length: </label><input class="break" type="text" value="2" /></div>
		<div class="col-sm-6"><label>Session Length: </label><input class="time" type="text" value="1" /></div>
		</div>
		<div class="countdown"></div>
		<button class="stopTimer">Stop</button>
		<button class="startTimer">Start</button>
	</div>
</body>
</html>